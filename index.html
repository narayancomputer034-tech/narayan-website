<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Narayan Services</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* --- STYLE CSS --- */
        :root {
            --primary: #2874f0; /* Flipkart Blue */
            --secondary: #fb641b; /* Orange Action Color */
            --bg: #f1f3f6;
            --text: #212121;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: Roboto, Arial, sans-serif; }
        body { background-color: var(--bg); padding-bottom: 70px; user-select: none; }

        /* HEADER */
        header { background: var(--primary); color: white; padding: 12px; position: sticky; top: 0; z-index: 1000; display: flex; align-items: center; gap: 15px; box-shadow: 0 2px 4px rgba(0,0,0,0.2); }
        .logo { font-size: 18px; font-weight: bold; flex-grow: 1; }
        
        /* BOTTOM NAV */
        .bottom-nav { position: fixed; bottom: 0; width: 100%; background: white; display: flex; justify-content: space-around; padding: 10px 0; border-top: 1px solid #eee; z-index: 2000; }
        .nav-item { text-align: center; color: #878787; font-size: 11px; cursor: pointer; }
        .nav-item i { font-size: 20px; display: block; margin-bottom: 2px; }
        .nav-item.active { color: var(--primary); }

        /* PRODUCT GRID */
        .product-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; padding: 8px; padding-top: 60px; } /* Added padding-top for header */
        .card { background: white; padding: 10px; border-radius: 4px; box-shadow: 0 1px 2px rgba(0,0,0,0.1); display: flex; flex-direction: column; }
        .card-img { width: 100%; height: 130px; object-fit: contain; margin-bottom: 10px; }
        .title { font-size: 14px; margin-bottom: 5px; height: 38px; overflow: hidden; color: #333; }
        .price { font-size: 16px; font-weight: 600; color: #212121; }
        .mrp { font-size: 12px; text-decoration: line-through; color: #878787; margin-left: 5px; }
        .off { font-size: 12px; color: #388e3c; font-weight: 600; margin-left: 5px; }
        
        .btn-row { display: flex; gap: 5px; margin-top: auto; }
        .add-btn { flex: 1; background: #ff9f00; color: white; border: none; padding: 8px; font-weight: 600; cursor: pointer; border-radius: 2px; }
        .buy-btn { flex: 1; background: var(--secondary); color: white; border: none; padding: 8px; font-weight: 600; cursor: pointer; border-radius: 2px; }

        /* MODALS (Forms) */
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 3000; align-items: flex-end; }
        .modal-content { background: white; width: 100%; padding: 20px; border-radius: 15px 15px 0 0; max-height: 90vh; overflow-y: auto; animation: slideUp 0.3s; }
        @keyframes slideUp { from {transform: translateY(100%);} to {transform: translateY(0);} }

        /* FORM INPUTS */
        .input-group { margin-bottom: 15px; }
        .input-group label { display: block; font-size: 12px; color: #666; margin-bottom: 5px; }
        .input-group input, .input-group textarea { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px; }
        
        /* PAYMENT OPTIONS */
        .pay-option { display: flex; align-items: center; padding: 15px; border: 1px solid #eee; margin-bottom: 10px; border-radius: 5px; cursor: pointer; }
        .pay-option.selected { border-color: var(--primary); background: #f0f7ff; }
        .pay-icon { width: 30px; margin-right: 15px; text-align: center; }

        /* ORDER HISTORY */
        .order-item { background: white; padding: 15px; margin-bottom: 10px; border-radius: 4px; border-left: 5px solid var(--primary); box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
        .status { font-size: 12px; font-weight: bold; color: green; float: right; }

        /* VIEWS */
        .view { display: none; padding-bottom: 80px; }
        .view.active { display: block; }

    </style>
</head>
<body>

    <header>
        <div class="logo">Narayan Services</div>
        <div onclick="switchView('cart')">
            <i class="fas fa-shopping-cart" style="font-size: 20px;"></i>
            <span id="cart-badge" style="background:red; font-size:10px; padding:2px 5px; border-radius:50%; position:relative; top:-10px; left:-5px;">0</span>
        </div>
    </header>

    <div id="home-view" class="view active">
        <div class="product-grid" id="product-list">
            </div>
    </div>

    <div id="cart-view" class="view" style="padding: 10px;">
        <h2>My Cart</h2>
        <div id="cart-items"></div>
        <div id="cart-total" style="font-weight:bold; margin:20px 0; font-size:18px;">Total: ₹0</div>
        <button class="buy-btn" style="width:100%; padding:15px; font-size:16px;" onclick="openAddressModal()">Place Order</button>
    </div>

    <div id="account-view" class="view" style="padding: 10px; padding-top: 60px;">
        <div style="background:white; padding:20px; text-align:center; border-radius:4px; margin-bottom:20px;">
            <i class="fas fa-user-circle" style="font-size:50px; color:#ddd;"></i>
            <h3>My Profile</h3>
            <p>+91 9708797335</p>
        </div>
        <h3>Order History</h3>
        <div id="order-history-list">
            </div>
    </div>

    <div class="modal" id="addressModal">
        <div class="modal-content">
            <h3>Step 1: Delivery Address</h3>
            <br>
            <div class="input-group">
                <label>Full Name</label>
                <input type="text" id="userName" placeholder="Enter Name">
            </div>
            <div class="input-group">
                <label>Mobile Number</label>
                <input type="tel" id="userPhone" placeholder="10-digit Mobile Number">
            </div>
            <div class="input-group">
                <label>Full Address (House No, Road, Village)</label>
                <textarea id="userAddr" rows="3" placeholder="Enter Address"></textarea>
            </div>
            <div class="input-group">
                <label>Pincode</label>
                <input type="number" id="userPin" placeholder="843328">
            </div>
            <button class="buy-btn" style="width:100%; padding:12px;" onclick="openPaymentModal()">Proceed to Payment</button>
            <button onclick="closeModals()" style="width:100%; padding:10px; background:none; border:none; color:red; margin-top:10px;">Cancel</button>
        </div>
    </div>

    <div class="modal" id="paymentModal">
        <div class="modal-content">
            <h3>Step 2: Payment Method</h3>
            <br>
            
            <div class="pay-option" onclick="selectPay('upi', this)">
                <div class="pay-icon"><i class="fab fa-google-pay" style="color:#212121; font-size:24px;"></i></div>
                <div>
                    <b>UPI (PhonePe / GPay)</b>
                    <p style="font-size:12px; color:#666;">Pay via WhatsApp link</p>
                </div>
            </div>

            <div class="pay-option" onclick="selectPay('card', this)">
                <div class="pay-icon"><i class="fas fa-credit-card" style="color:#2874f0; font-size:20px;"></i></div>
                <div>
                    <b>Credit / Debit Card</b>
                    <p style="font-size:12px; color:#666;">Card machine on delivery</p>
                </div>
            </div>

            <div class="pay-option selected" onclick="selectPay('cod', this)">
                <div class="pay-icon"><i class="fas fa-money-bill-wave" style="color:green; font-size:20px;"></i></div>
                <div>
                    <b>Cash on Delivery</b>
                    <p style="font-size:12px; color:#666;">Pay cash at doorstep</p>
                </div>
            </div>

            <button class="buy-btn" style="width:100%; padding:15px; margin-top:20px; font-size:16px;" onclick="confirmOrder()">CONFIRM ORDER</button>
        </div>
    </div>

    <div class="bottom-nav">
        <div class="nav-item active" onclick="switchView('home'); updateNav(this)">
            <i class="fas fa-home"></i> Home
        </div>
        <div class="nav-item" onclick="switchView('cart'); updateNav(this)">
            <i class="fas fa-shopping-cart"></i> Cart
        </div>
        <div class="nav-item" onclick="switchView('account'); updateNav(this)">
            <i class="fas fa-list-alt"></i> Orders
        </div>
    </div>

    <script>
        // DATA
        const products = [
            { id: 1, name: "HP 15s Laptop", price: 35990, mrp: 45000, img: "https://m.media-amazon.com/images/I/71ItMeqpnzL._AC_UY327_FMwebp_QL65_.jpg" },
            { id: 2, name: "Samsung Galaxy M14", price: 12490, mrp: 18990, img: "https://m.media-amazon.com/images/I/817WWpaQqbL._AC_UY327_FMwebp_QL65_.jpg" },
            { id: 3, name: "boAt Airdopes 141", price: 1299, mrp: 4490, img: "https://m.media-amazon.com/images/I/61KNJav3v9L._AC_UY327_FMwebp_QL65_.jpg" },
            { id: 4, name: "Canon Printer", price: 5999, mrp: 7500, img: "https://m.media-amazon.com/images/I/51+u0a+JpQL._AC_UY327_FMwebp_QL65_.jpg" },
            { id: 5, name: "Wireless Mouse", price: 499, mrp: 999, img: "https://m.media-amazon.com/images/I/51kdFkdrVXL._AC_UY327_FMwebp_QL65_.jpg" },
            { id: 6, name: "64GB Pen Drive", price: 450, mrp: 1000, img: "https://m.media-amazon.com/images/I/61aiZlJjWGL._AC_UY327_FMwebp_QL65_.jpg" }
        ];

        let cart = [];
        let selectedPayment = 'Cash on Delivery';

        // 1. RENDER PRODUCTS
        const list = document.getElementById('product-list');
        products.forEach(p => {
            const off = Math.round(((p.mrp - p.price)/p.mrp)*100);
            list.innerHTML += `
                <div class="card">
                    <img src="${p.img}" class="card-img">
                    <div class="title">${p.name}</div>
                    <div>
                        <span class="price">₹${p.price}</span>
                        <span class="mrp">₹${p.mrp}</span>
                        <span class="off">${off}% Off</span>
                    </div>
                    <div class="btn-row">
                        <button class="add-btn" onclick="addToCart(${p.id})">ADD</button>
                        <button class="buy-btn" onclick="buyNow(${p.id})">BUY</button>
                    </div>
                </div>
            `;
        });

        // 2. VIEW SWITCHING
        function switchView(viewName) {
            document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
            document.getElementById(viewName+'-view').classList.add('active');
            if(viewName === 'cart') renderCart();
            if(viewName === 'account') loadHistory();
        }

        function updateNav(el) {
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            el.classList.add('active');
        }

        // 3. CART LOGIC
        function addToCart(id) {
            const item = products.find(p => p.id === id);
            cart.push(item);
            document.getElementById('cart-badge').innerText = cart.length;
            alert("Added to Cart");
        }

        function buyNow(id) {
            addToCart(id);
            switchView('cart');
        }

        function renderCart() {
            const div = document.getElementById('cart-items');
            div.innerHTML = "";
            let total = 0;
            if(cart.length === 0) {
                div.innerHTML = "<p>Cart is Empty</p>";
                document.getElementById('cart-total').innerText = "Total: ₹0";
                return;
            }
            cart.forEach((c, index) => {
                total += c.price;
                div.innerHTML += `
                    <div style="background:white; padding:10px; margin-bottom:5px; border-bottom:1px solid #eee; display:flex; justify-content:space-between;">
                        <div>
                            <b>${c.name}</b><br>
                            <span style="color:green;">₹${c.price}</span>
                        </div>
                        <i class="fas fa-trash" style="color:red; cursor:pointer;" onclick="removeFromCart(${index})"></i>
                    </div>
                `;
            });
            document.getElementById('cart-total').innerText = "Total: ₹" + total;
        }

        function removeFromCart(index) {
            cart.splice(index, 1);
            document.getElementById('cart-badge').innerText = cart.length;
            renderCart();
        }

        // 4. CHECKOUT LOGIC
        function openAddressModal() {
            if(cart.length === 0) return alert("Cart is empty");
            document.getElementById('addressModal').style.display = "flex";
        }

        function openPaymentModal() {
            const name = document.getElementById('userName').value;
            const mobile = document.getElementById('userPhone').value;
            const addr = document.getElementById('userAddr').value;
            if(!name || !mobile || !addr) return alert("Please fill all details");
            
            document.getElementById('addressModal').style.display = "none";
            document.getElementById('paymentModal').style.display = "flex";
        }

        function selectPay(type, el) {
            document.querySelectorAll('.pay-option').forEach(d => d.classList.remove('selected'));
            el.classList.add('selected');
            if(type === 'upi') selectedPayment = "UPI (Online)";
            if(type === 'card') selectedPayment = "Card on Delivery";
            if(type === 'cod') selectedPayment = "Cash on Delivery";
        }

        function confirmOrder() {
            const name = document.getElementById('userName').value;
            const mobile = document.getElementById('userPhone').value;
            const addr = document.getElementById('userAddr').value;
            let total = 0;
            let itemsList = "";
            
            cart.forEach(c => { total += c.price; itemsList += c.name + ", "; });

            // SAVE HISTORY (LocalStorage)
            const orderData = {
                date: new Date().toLocaleDateString(),
                items: itemsList,
                amount: total,
                status: "Order Placed"
            };
            let history = JSON.parse(localStorage.getItem('myOrders')) || [];
            history.unshift(orderData);
            localStorage.setItem('myOrders', JSON.stringify(history));

            // WHATSAPP SEND
            let msg = `*NEW ORDER ALERT* %0A-----------------%0A`;
            msg += `*Name:* ${name}%0A`;
            msg += `*Phone:* ${mobile}%0A`;
            msg += `*Address:* ${addr}%0A`;
            msg += `*Items:* ${itemsList}%0A`;
            msg += `*Total Amount:* ₹${total}%0A`;
            msg += `*Payment Mode:* ${selectedPayment}%0A`;
            msg += `-----------------%0A`;
            msg += `Please confirm my order.`;

            // Clear Cart & Redirect
            cart = [];
            document.getElementById('cart-badge').innerText = 0;
            window.open(`https://wa.me/919708797335?text=${msg}`, '_blank');
            closeModals();
            switchView('account'); // Show history after return
        }

        // 5. HISTORY LOGIC
        function loadHistory() {
            const history = JSON.parse(localStorage.getItem('myOrders')) || [];
            const listDiv = document.getElementById('order-history-list');
            listDiv.innerHTML = "";
            
            if(history.length === 0) {
                listDiv.innerHTML = "<p>No orders yet.</p>";
                return;
            }

            history.forEach(order => {
                listDiv.innerHTML += `
                    <div class="order-item">
                        <span class="status">${order.status}</span>
                        <b>Date: ${order.date}</b><br>
                        <p style="font-size:13px; color:#555; margin-top:5px;">${order.items}</p>
                        <div style="margin-top:5px; font-weight:bold;">Amount: ₹${order.amount}</div>
                    </div>
                `;
            });
        }

        function closeModals() {
            document.querySelectorAll('.modal').forEach(m => m.style.display = "none");
        }

    </script>
</body>
</html>
